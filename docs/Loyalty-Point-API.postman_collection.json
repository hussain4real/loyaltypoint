{
    "info": {
        "_postman_id": "loyalty-point-api-collection",
        "name": "Loyalty Point API",
        "description": "Multi-provider loyalty point system API collection.\n\n## Setup\n1. Import this collection into Postman\n2. Set the `base_url` variable to your API URL\n3. Use the Register or Login endpoints to get a token\n4. The token will be automatically saved to the `auth_token` variable\n\n## Authentication\nMost endpoints require a Bearer token. After login, the token is automatically set.",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "variable": [
        {
            "key": "base_url",
            "value": "http://127.0.0.1:8000/api/v1",
            "type": "string"
        },
        {
            "key": "auth_token",
            "value": "",
            "type": "string"
        },
        {
            "key": "customer_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "provider_slug",
            "value": "loyalty-plus",
            "type": "string"
        }
    ],
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{auth_token}}",
                "type": "string"
            }
        ]
    },
    "item": [
        {
            "name": "Authentication",
            "description": "User registration, login, and session management endpoints.",
            "item": [
                {
                    "name": "Register",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.collectionVariables.set('auth_token', jsonData.token);",
                                    "    console.log('Token saved to auth_token variable');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"name\": \"John Doe\",\n    \"email\": \"john@example.com\",\n    \"password\": \"password123\",\n    \"password_confirmation\": \"password123\",\n    \"device_name\": \"Postman\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/auth/register",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "auth",
                                "register"
                            ]
                        },
                        "description": "Register a new user and receive an API token.\n\nThe token is automatically saved to the `auth_token` collection variable."
                    },
                    "response": []
                },
                {
                    "name": "Login",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.collectionVariables.set('auth_token', jsonData.token);",
                                    "    console.log('Token saved to auth_token variable');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"john@example.com\",\n    \"password\": \"password123\",\n    \"device_name\": \"Postman\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/auth/login",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "auth",
                                "login"
                            ]
                        },
                        "description": "Login with email and password to receive an API token.\n\nThe token is automatically saved to the `auth_token` collection variable."
                    },
                    "response": []
                },
                {
                    "name": "Get Current User",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/auth/user",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "auth",
                                "user"
                            ]
                        },
                        "description": "Get the authenticated user's profile."
                    },
                    "response": []
                },
                {
                    "name": "Logout",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/auth/logout",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "auth",
                                "logout"
                            ]
                        },
                        "description": "Revoke the current access token."
                    },
                    "response": []
                },
                {
                    "name": "Logout All Devices",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/auth/logout-all",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "auth",
                                "logout-all"
                            ]
                        },
                        "description": "Revoke all access tokens for the user (logout from all devices)."
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "Vendor OTP Authentication",
            "description": "OTP-based authentication flow for vendor terminals.\n\n## Two Authentication Flows\n\n### 1. First-Time Linking (Platform Email)\nUse `email` (platform email) to identify and authenticate a user. Requires `provider`. Include `vendor_email` during verification to create the link.\n\n### 2. Linked Account Authentication (Vendor Email)\nOnce an account is linked, use `vendor_email` alone to identify the user. No `provider` needed - it's derived from the link. The OTP will be sent to the vendor_email address.",
            "item": [
                {
                    "name": "Request OTP (Platform Email)",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"alice@example.com\",\n    \"vendor_name\": \"Store Terminal #1\",\n    \"provider\": \"{{provider_slug}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vendor/auth/request-otp",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "auth",
                                "request-otp"
                            ]
                        },
                        "description": "Send a one-time password to the user's platform email for first-time linking.\n\nThe OTP expires in 10 minutes.\n\n**Use this for first-time authentication** when the account is not yet linked to a vendor_email.\n\n**Required fields:**\n- `email` - User's registered platform email\n- `vendor_name` - Vendor/terminal identifier\n- `provider` - Provider slug (e.g., `loyalty-plus`)"
                    },
                    "response": []
                },
                {
                    "name": "Request OTP (Vendor Email - Linked)",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"vendor_email\": \"alice.customer@vendor.com\",\n    \"vendor_name\": \"Store Terminal #1\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vendor/auth/request-otp",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "auth",
                                "request-otp"
                            ]
                        },
                        "description": "Send a one-time password to the vendor_email for already-linked accounts.\n\nThe OTP expires in 10 minutes.\n\n**Use this for returning customers** whose account is already linked to this vendor_email.\n\n**Required fields:**\n- `vendor_email` - Vendor's customer email (must be already linked)\n- `vendor_name` - Vendor/terminal identifier\n\n**Note:** Provider is automatically derived from the link. Returns 404 if no account is linked to this vendor_email."
                    },
                    "response": []
                },
                {
                    "name": "Verify OTP (First-Time Linking)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    var jsonData = pm.response.json();",
                                    "    if (jsonData.access_token) {",
                                    "        pm.collectionVariables.set('auth_token', jsonData.access_token);",
                                    "        console.log('Token saved to auth_token variable');",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"alice@example.com\",\n    \"code\": \"123456\",\n    \"device_name\": \"Store Terminal #1\",\n    \"provider\": \"{{provider_slug}}\",\n    \"vendor_email\": \"alice.customer@vendor.com\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vendor/auth/verify-otp",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "auth",
                                "verify-otp"
                            ]
                        },
                        "description": "Verify the OTP code and create a link between the platform user and vendor_email.\n\nReplace `123456` with the actual code received via email.\n\n**Use this for first-time linking** to associate the vendor's customer email with the platform user.\n\n**Required fields:**\n- `email` - User's platform email (used to look up user)\n- `code` - OTP code from email\n- `device_name` - Device identifier for the token\n- `provider` - Provider slug\n- `vendor_email` - Vendor's customer email to link\n\n**What happens:**\n1. User is verified via platform email + OTP\n2. A link is created between vendor_email and this user for this provider\n3. Future authentications can use vendor_email alone\n\nThe token is automatically saved to the `auth_token` collection variable."
                    },
                    "response": []
                },
                {
                    "name": "Verify OTP (Vendor Email - Linked)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    var jsonData = pm.response.json();",
                                    "    if (jsonData.access_token) {",
                                    "        pm.collectionVariables.set('auth_token', jsonData.access_token);",
                                    "        console.log('Token saved to auth_token variable');",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"vendor_email\": \"alice.customer@vendor.com\",\n    \"code\": \"123456\",\n    \"device_name\": \"Store Terminal #1\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vendor/auth/verify-otp",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "auth",
                                "verify-otp"
                            ]
                        },
                        "description": "Verify the OTP code for a linked account using vendor_email.\n\nReplace `123456` with the actual code received at the vendor_email.\n\n**Use this for returning customers** whose account is already linked.\n\n**Required fields:**\n- `vendor_email` - Vendor's customer email (must be linked)\n- `code` - OTP code from vendor_email\n- `device_name` - Device identifier for the token\n\n**Note:** Provider is automatically derived from the link. Returns 404 if no account is linked to this vendor_email.\n\nThe token is automatically saved to the `auth_token` collection variable."
                    },
                    "response": []
                },
                {
                    "name": "Resend OTP (Platform Email)",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"alice@example.com\",\n    \"vendor_name\": \"Store Terminal #1\",\n    \"provider\": \"{{provider_slug}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vendor/auth/resend-otp",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "auth",
                                "resend-otp"
                            ]
                        },
                        "description": "Resend a new OTP code to the user's platform email. This invalidates any previous OTP codes.\n\n**Use for first-time authentication** when the account is not yet linked."
                    },
                    "response": []
                },
                {
                    "name": "Resend OTP (Vendor Email - Linked)",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"vendor_email\": \"alice.customer@vendor.com\",\n    \"vendor_name\": \"Store Terminal #1\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vendor/auth/resend-otp",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "auth",
                                "resend-otp"
                            ]
                        },
                        "description": "Resend a new OTP code to the linked vendor_email. This invalidates any previous OTP codes.\n\n**Use for returning customers** whose account is already linked.\n\n**Note:** Provider is automatically derived from the link. Returns 404 if no account is linked to this vendor_email."
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "Vendor Account Linking",
            "description": "Vendor account linking allows vendors to maintain a persistent relationship between their customer emails and platform users.",
            "item": [
                {
                    "name": "Lookup by Vendor Email",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/vendor/customers/by-vendor-email?vendor_email=alice@vendor.com",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "customers",
                                "by-vendor-email"
                            ],
                            "query": [
                                {
                                    "key": "vendor_email",
                                    "value": "alice@vendor.com",
                                    "description": "The vendor's customer email"
                                },
                                {
                                    "key": "provider",
                                    "value": "{{provider_slug}}",
                                    "description": "Optional: Filter by provider slug",
                                    "disabled": true
                                }
                            ]
                        },
                        "description": "Look up all platform accounts linked to a vendor email.\n\nReturns linked accounts with their point balances for each provider.\n\n**Query Parameters:**\n- `vendor_email` (required) - The vendor's customer email\n- `provider` (optional) - Filter by specific provider slug"
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "Vendor Cross-Account Exchange",
            "description": "Vendor cross-account exchange allows vendors to facilitate point exchanges between different platform users who are linked to the same vendor email.",
            "item": [
                {
                    "name": "Preview Exchange",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"vendor_email\": \"alice@vendor.com\",\n    \"from_provider\": \"airline-miles\",\n    \"to_provider\": \"rewards-hub\",\n    \"points\": 1000\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vendor/points/exchange/preview",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "points",
                                "exchange",
                                "preview"
                            ]
                        },
                        "description": "Preview a cross-account exchange without executing it.\n\nReturns detailed breakdown of fees and conversion including:\n- From/To account details with current and projected balances\n- Three-tier fee structure (source fee, app fee, destination fee)\n- Value-based conversion calculation"
                    },
                    "response": []
                },
                {
                    "name": "Execute Exchange",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"vendor_email\": \"alice@vendor.com\",\n    \"from_provider\": \"airline-miles\",\n    \"to_provider\": \"rewards-hub\",\n    \"points\": 1000\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vendor/points/exchange",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "points",
                                "exchange"
                            ]
                        },
                        "description": "Execute a cross-account exchange between two platform users linked to the same vendor email.\n\n**Requirements:**\n- Both platform accounts must be linked to the same vendor email\n- Source account must have sufficient balance\n- Exchange must result in at least 1 point received\n\n**How it works:**\n1. Points are deducted from source user's account\n2. Value-based conversion with three-tier fees is applied\n3. Points are credited to destination user's account\n4. Both transactions are linked via exchange_id"
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "Vendor Points",
            "description": "Vendor-scoped point endpoints for authenticated users. These endpoints automatically scope to the provider linked via vendor_email - no provider parameter needed.\n\n**Requires:** Bearer token from vendor OTP authentication.",
            "item": [
                {
                    "name": "Get Balance (Auto-Scoped)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/vendor/points/balance",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "points",
                                "balance"
                            ]
                        },
                        "description": "Get the authenticated user's point balance for their linked provider.\n\n**Auto-scoped:** No provider parameter needed - automatically uses the provider from the vendor account link.\n\n**Returns 400** if the user has no vendor account link. In that case, use the standard `/points/balance?provider=` endpoint instead."
                    },
                    "response": []
                },
                {
                    "name": "Get Transactions (Auto-Scoped)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/vendor/points/transactions",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "points",
                                "transactions"
                            ]
                        },
                        "description": "Get the authenticated user's transaction history for their linked provider.\n\n**Auto-scoped:** No provider parameter needed - automatically uses the provider from the vendor account link.\n\n**Returns 400** if the user has no vendor account link. In that case, use the standard `/points/transactions?provider=` endpoint instead."
                    },
                    "response": []
                },
                {
                    "name": "Get Transactions (Filtered)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/vendor/points/transactions?from=2025-01-01&to=2025-12-31&per_page=10",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "vendor",
                                "points",
                                "transactions"
                            ],
                            "query": [
                                {
                                    "key": "from",
                                    "value": "2025-01-01",
                                    "description": "Filter transactions from this date (YYYY-MM-DD)"
                                },
                                {
                                    "key": "to",
                                    "value": "2025-12-31",
                                    "description": "Filter transactions up to this date (YYYY-MM-DD)"
                                },
                                {
                                    "key": "per_page",
                                    "value": "10",
                                    "description": "Number of results per page (max 100)"
                                }
                            ]
                        },
                        "description": "Get the authenticated user's transaction history with date filters.\n\n**Query Parameters:**\n- `from` - Filter from date (YYYY-MM-DD)\n- `to` - Filter to date (YYYY-MM-DD)\n- `per_page` - Results per page (default 15, max 100)"
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "Providers",
            "description": "List and view loyalty point providers.",
            "item": [
                {
                    "name": "List All Providers",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/providers",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "providers"
                            ]
                        },
                        "description": "List all active loyalty point providers.\n\nThis is a public endpoint - no authentication required."
                    },
                    "response": []
                },
                {
                    "name": "Get Provider Details",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/providers/{{provider_slug}}",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "providers",
                                "{{provider_slug}}"
                            ]
                        },
                        "description": "Get details of a specific provider by slug.\n\nThis is a public endpoint - no authentication required."
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "Points (Self-Service)",
            "description": "Endpoints for authenticated users to view their own points.",
            "item": [
                {
                    "name": "Get My Balance (All Providers)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/points/balance",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "points",
                                "balance"
                            ]
                        },
                        "description": "Get the authenticated user's point balance across all providers."
                    },
                    "response": []
                },
                {
                    "name": "Get My Balance (Specific Provider)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/points/balance?provider={{provider_slug}}",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "points",
                                "balance"
                            ],
                            "query": [
                                {
                                    "key": "provider",
                                    "value": "{{provider_slug}}"
                                }
                            ]
                        },
                        "description": "Get the authenticated user's point balance for a specific provider."
                    },
                    "response": []
                },
                {
                    "name": "Get My Transactions",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/points/transactions",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "points",
                                "transactions"
                            ]
                        },
                        "description": "Get the authenticated user's transaction history across all providers."
                    },
                    "response": []
                },
                {
                    "name": "Get My Transactions (Filtered)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/points/transactions?provider={{provider_slug}}&from=2025-01-01&to=2025-12-31&per_page=10",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "points",
                                "transactions"
                            ],
                            "query": [
                                {
                                    "key": "provider",
                                    "value": "{{provider_slug}}",
                                    "description": "Filter by provider slug"
                                },
                                {
                                    "key": "from",
                                    "value": "2025-01-01",
                                    "description": "Start date (YYYY-MM-DD)"
                                },
                                {
                                    "key": "to",
                                    "value": "2025-12-31",
                                    "description": "End date (YYYY-MM-DD)"
                                },
                                {
                                    "key": "per_page",
                                    "value": "10",
                                    "description": "Results per page (max 100)"
                                }
                            ]
                        },
                        "description": "Get the authenticated user's transaction history with filters."
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "Point Exchange",
            "description": "Exchange points between different providers using value-based conversion.\n\n## How It Works\nPoints are converted to real currency value, fees are applied, then converted to destination points.\n\n## Fee Structure\nThree fees are combined into a single transfer fee:\n- Source provider fee (`transfer_fee_percent`)\n- Destination provider fee (`transfer_fee_percent`)\n- App fee (configurable, default 5%)\n\n## Calculation\n1. `gross_value = points × source.points_to_value_ratio`\n2. `total_fee_percent = source_fee + dest_fee + app_fee`\n3. `net_value = gross_value - (gross_value × total_fee_percent / 100)`\n4. `points_received = floor(net_value / dest.points_to_value_ratio)`",
            "item": [
                {
                    "name": "Preview Exchange",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"from_provider\": \"loyalty-plus\",\n    \"to_provider\": \"rewards-hub\",\n    \"points\": 100\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/points/exchange/preview",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "points",
                                "exchange",
                                "preview"
                            ]
                        },
                        "description": "Preview an exchange calculation without executing it.\n\n**Response includes:**\n- `from_provider` / `to_provider` - Provider details with `points_to_value_ratio`\n- `points_to_exchange` - Input points\n- `gross_value` - Value before fees\n- `fees` - Breakdown of all three fees (source, destination, app)\n- `total_fee_percent` / `total_fee_value` - Combined fee\n- `net_value` - Value after fees\n- `points_to_receive` - Final points in destination provider\n\n**Example:** 100 points at 0.1 ratio = $10 gross value. With 10% total fees = $9 net value. At 1.0 ratio = 9 destination points."
                    },
                    "response": []
                },
                {
                    "name": "Execute Exchange",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"from_provider\": \"loyalty-plus\",\n    \"to_provider\": \"rewards-hub\",\n    \"points\": 100\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/points/exchange",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "points",
                                "exchange"
                            ]
                        },
                        "description": "Execute a point exchange between providers.\n\n**Response includes:**\n- `points_sent` - Points deducted from source\n- `gross_value` - Value before fees\n- `total_fee_percent` / `total_fee_value` - Combined transfer fee\n- `net_value` - Value after fees\n- `points_received` - Points added to destination\n- `transfer_out` - Debit transaction from source provider\n- `transfer_in` - Credit transaction to destination provider\n\n**Note:** Returns 422 if insufficient balance in source provider."
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "Third-Party Customer Operations",
            "description": "Endpoints for vendors/partners to manage customer points.\n\nThese require tokens with specific abilities:\n- `points:read` - Read balances\n- `transactions:read` - Read history\n- `points:award` - Award points\n- `points:deduct` - Deduct points",
            "item": [
                {
                    "name": "Get Customer Balance",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/providers/{{provider_slug}}/customers/{{customer_id}}/points",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "providers",
                                "{{provider_slug}}",
                                "customers",
                                "{{customer_id}}",
                                "points"
                            ]
                        },
                        "description": "Get a customer's point balance for a specific provider.\n\nRequires `points:read` token ability."
                    },
                    "response": []
                },
                {
                    "name": "Get Customer Transactions",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/providers/{{provider_slug}}/customers/{{customer_id}}/transactions",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "providers",
                                "{{provider_slug}}",
                                "customers",
                                "{{customer_id}}",
                                "transactions"
                            ]
                        },
                        "description": "Get a customer's transaction history for a specific provider.\n\nRequires `transactions:read` token ability."
                    },
                    "response": []
                },
                {
                    "name": "Get Customer Transactions (Filtered)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/providers/{{provider_slug}}/customers/{{customer_id}}/transactions?from=2025-01-01&to=2025-12-31&per_page=10",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "providers",
                                "{{provider_slug}}",
                                "customers",
                                "{{customer_id}}",
                                "transactions"
                            ],
                            "query": [
                                {
                                    "key": "from",
                                    "value": "2025-01-01",
                                    "description": "Start date (YYYY-MM-DD)"
                                },
                                {
                                    "key": "to",
                                    "value": "2025-12-31",
                                    "description": "End date (YYYY-MM-DD)"
                                },
                                {
                                    "key": "per_page",
                                    "value": "10",
                                    "description": "Results per page (max 100)"
                                }
                            ]
                        },
                        "description": "Get a customer's transaction history with date filters.\n\nRequires `transactions:read` token ability."
                    },
                    "response": []
                },
                {
                    "name": "Award Points to Customer",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"points\": 150,\n    \"description\": \"Purchase #ORD-12345\",\n    \"metadata\": {\n        \"order_id\": \"ORD-12345\",\n        \"store_id\": \"STORE-001\"\n    }\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/providers/{{provider_slug}}/customers/{{customer_id}}/points/award",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "providers",
                                "{{provider_slug}}",
                                "customers",
                                "{{customer_id}}",
                                "points",
                                "award"
                            ]
                        },
                        "description": "Award points to a customer for a specific provider.\n\nRequires `points:award` token ability.\n\n**Request Body:**\n- `points` (required): Points to award (1-1,000,000)\n- `description` (required): Transaction description\n- `metadata` (optional): Additional data object"
                    },
                    "response": []
                },
                {
                    "name": "Deduct Points from Customer",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"points\": 100,\n    \"description\": \"Reward redemption - Free Coffee\",\n    \"metadata\": {\n        \"reward_id\": \"RWD-001\",\n        \"redeemed_at\": \"STORE-001\"\n    }\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/providers/{{provider_slug}}/customers/{{customer_id}}/points/deduct",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "providers",
                                "{{provider_slug}}",
                                "customers",
                                "{{customer_id}}",
                                "points",
                                "deduct"
                            ]
                        },
                        "description": "Deduct points from a customer (e.g., for redemptions).\n\nRequires `points:deduct` token ability.\n\n**Request Body:**\n- `points` (required): Points to deduct (1-1,000,000)\n- `description` (required): Transaction description\n- `metadata` (optional): Additional data object\n\n**Note:** Returns 422 if customer has insufficient balance."
                    },
                    "response": []
                }
            ]
        }
    ]
}
